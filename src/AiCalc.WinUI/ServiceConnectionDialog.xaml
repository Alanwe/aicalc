<?xml version="1.0" encoding="utf-8"?>
<ContentDialog
    x:Class="AiCalc.ServiceConnectionDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="AI Service Connection"
    PrimaryButtonText="Save"
    CloseButtonText="Cancel"
    DefaultButton="Primary"
    PrimaryButtonClick="SaveButton_Click">

    <ScrollViewer MaxHeight="500" MaxWidth="500">
        <StackPanel Spacing="16" Padding="4">
            <TextBox x:Name="NameTextBox"
                     Header="Service Name *"
                     PlaceholderText="e.g., Azure OpenAI Production"
                     Text="{x:Bind Connection.Name, Mode=TwoWay}" />

            <ComboBox x:Name="ProviderComboBox"
                      Header="Provider *"
                      SelectedItem="{x:Bind Connection.Provider, Mode=TwoWay}"
                      HorizontalAlignment="Stretch">
                <x:String>Azure OpenAI</x:String>
                <x:String>OpenAI</x:String>
                <x:String>Anthropic</x:String>
                <x:String>Google AI</x:String>
                <x:String>Hugging Face</x:String>
                <x:String>Local (Ollama)</x:String>
                <x:String>Custom</x:String>
            </ComboBox>

            <TextBox x:Name="EndpointTextBox"
                     Header="Endpoint *"
                     PlaceholderText="e.g., https://your-resource.openai.azure.com/"
                     Text="{x:Bind Connection.Endpoint, Mode=TwoWay}" />

            <PasswordBox x:Name="ApiKeyPasswordBox"
                         Header="API Key"
                         PlaceholderText="Enter your API key"
                         Password="{x:Bind Connection.ApiKey, Mode=TwoWay}" />

            <TextBox x:Name="ModelTextBox"
                     Header="Model"
                     PlaceholderText="e.g., gpt-4, claude-3-opus"
                     Text="{x:Bind Connection.Model, Mode=TwoWay}" />

            <TextBox x:Name="DeploymentTextBox"
                     Header="Deployment Name (Azure only)"
                     PlaceholderText="e.g., gpt-4-deployment"
                     Text="{x:Bind Connection.Deployment, Mode=TwoWay}" />

            <InfoBar Title="Connection Tips"
                     Severity="Informational"
                     IsOpen="True"
                     IsClosable="False">
                <InfoBar.Content>
                    <StackPanel Spacing="4">
                        <TextBlock TextWrapping="Wrap" FontSize="12">
                            <Run Text="• Azure OpenAI: Use format https://[resource].openai.azure.com/" />
                        </TextBlock>
                        <TextBlock TextWrapping="Wrap" FontSize="12">
                            <Run Text="• OpenAI: Endpoint is https://api.openai.com/v1" />
                        </TextBlock>
                        <TextBlock TextWrapping="Wrap" FontSize="12">
                            <Run Text="• Local/Ollama: Use http://localhost:11434" />
                        </TextBlock>
                    </StackPanel>
                </InfoBar.Content>
            </InfoBar>

            <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                    BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="12">
                <StackPanel Spacing="8">
                    <TextBlock Text="Quick Presets" 
                               FontWeight="SemiBold" 
                               FontSize="12" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Content="Azure OpenAI" 
                                Click="PresetAzureOpenAI_Click"
                                Style="{StaticResource AccentButtonStyle}"
                                FontSize="12"
                                Padding="8,4" />
                        <Button Content="OpenAI" 
                                Click="PresetOpenAI_Click"
                                FontSize="12"
                                Padding="8,4" />
                        <Button Content="Local Ollama" 
                                Click="PresetOllama_Click"
                                FontSize="12"
                                Padding="8,4" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</ContentDialog>
